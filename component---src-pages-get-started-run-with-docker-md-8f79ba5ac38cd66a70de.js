(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{F1Ga:function(e,a,n){"use strict";n.r(a),n.d(a,"_frontmatter",(function(){return c})),n.d(a,"default",(function(){return l}));n("91GP"),n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("FlsD"),n("q1tI");var t=n("7ljp"),i=n("hhGP");n("qKvR");function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}var c={};void 0!==c&&c&&c===Object(c)&&Object.isExtensible(c)&&!c.hasOwnProperty("__filemeta")&&Object.defineProperty(c,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/pages/Get_started/Run_with_Docker.md"}});var o={_frontmatter:c},h=i.a;function l(e){var a=e.components,n=function(e,a){if(null==e)return{};var n,t,i={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(i[n]=e[n]);return i}(e,["components"]);return Object(t.b)(h,s({},o,n,{components:a,mdxType:"MDXLayout"}),Object(t.b)("h1",{id:"running-spark-in-docker"},"Running Spark in Docker"),Object(t.b)("p",null,"Spark can run in a Docker. This is a sample Dockerfile for running Spark."),Object(t.b)("pre",{className:"default-dark vscode-highlight","data-language":""},Object(t.b)("code",s({parentName:"pre"},{className:"vscode-highlight-code"}),Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"FROM mcr.microsoft.com/dotnet/core/aspnet:2.2-stretch-slim AS base"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"WORKDIR /app"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"EXPOSE 80"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"EXPOSE 443"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"})),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"FROM mcr.microsoft.com/dotnet/core/sdk:2.2-stretch AS build"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"WORKDIR /src"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'COPY ["./src/Spark.Web/", "Spark.Web/"]'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'COPY ["./src/Spark.Engine/", "Spark.Engine/"]'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'COPY ["./src/Spark.Mongo/", "Spark.Mongo/"]'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'RUN dotnet restore "/src/Spark.Web/Spark.Web.csproj"'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"COPY . ."),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'RUN dotnet build "/src/Spark.Web/Spark.Web.csproj" -c Release -o /app'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"})),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"FROM build AS publish"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'RUN dotnet publish "/src/Spark.Web/Spark.Web.csproj" -c Release -o /app'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"})),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"FROM base AS final"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"WORKDIR /app"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"COPY --from=publish /app ."),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"# COPY --from=build /src/Spark.Web/example_data/fhir_examples ./fhir_examples"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"})),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'ENTRYPOINT ["dotnet", "Spark.Web.dll"]'))),Object(t.b)("p",null,"If you want to run the Mongo database as well, you could configure it with a ",Object(t.b)("inlineCode",{parentName:"p"},"docker-compse.yml"),"-file:"),Object(t.b)("pre",{className:"default-dark vscode-highlight","data-language":""},Object(t.b)("code",s({parentName:"pre"},{className:"vscode-highlight-code"}),Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'version: "3"'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"services:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"  spark:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    container_name: spark"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    restart: always"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    build:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      context: ."),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      dockerfile: Dockerfile"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    environment:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      - StoreSettings__ConnectionString=mongodb://root:CosmicTopSecret@mongodb:27017/spark?authSource=admin"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      - SparkSettings__Endpoint=http://localhost:5555/fhir"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    ports:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'      - "5555:80"'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'      - "44348:443"'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    links:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      - mongodb"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    depends_on:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      - mongodb"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"  mongodb:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    container_name: mongodb"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    image: mongo"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    environment:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      MONGO_INITDB_ROOT_USERNAME: root"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      MONGO_INITDB_ROOT_PASSWORD: CosmicTopSecret"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    ports:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'      - "17017:27017"'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"  mongosetup:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    container_name: mongosetup"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    image: mongo"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    volumes:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      - ./src/Spark.Web/example_data/db_dump:/data/db_dump"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    depends_on:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      - mongodb"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    links:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      - mongodb"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    entrypoint:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),'      ["mongorestore", "--uri=mongodb://root:CosmicTopSecret@mongodb:27017/spark", "--drop", "--archive=/data/db_dump/dstu2.archive.gz", "--gzip"]'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"    environment:"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"vscode-highlight-line"}),"      WAIT_HOSTS: mongodb:27017"))),Object(t.b)("style",{className:"vscode-highlight-styles"},"\n  :root {\n  --vscode-highlight-padding-v: 1rem;\n  --vscode-highlight-padding-h: 1.5rem;\n  --vscode-highlight-padding-top: var(--vscode-highlight-padding-v);\n  --vscode-highlight-padding-right: var(--vscode-highlight-padding-h);\n  --vscode-highlight-padding-bottom: var(--vscode-highlight-padding-v);\n  --vscode-highlight-padding-left: var(--vscode-highlight-padding-h);\n  --vscode-highlight-border-radius: 8px;\n\n  --vscode-highlight-line-highlighted-background-color: transparent;\n  --vscode-highlight-line-highlighted-border-width: 4px;\n  --vscode-highlight-line-highlighted-border-color: transparent;\n}\n\n.vscode-highlight {\n  overflow: auto;\n  -webkit-overflow-scrolling: touch;\n  padding-top: 1rem;\n  padding-top: var(--vscode-highlight-padding-top);\n  padding-bottom: 1rem;\n  padding-bottom: var(--vscode-highlight-padding-bottom);\n  border-radius: 8px;\n  border-radius: var(--vscode-highlight-border-radius);\n  font-feature-settings: normal;\n}\n\n.vscode-highlight-code {\n  display: inline-block;\n  min-width: 100%;\n}\n\n.vscode-highlight-line {\n  display: inline-block;\n  box-sizing: border-box;\n  width: 100%;\n  padding-left: 1.5rem;\n  padding-left: var(--vscode-highlight-padding-left);\n  padding-right: 1.5rem;\n  padding-right: var(--vscode-highlight-padding-right);\n}\n\n.vscode-highlight-line-highlighted {\n  background-color: var(--vscode-highlight-line-highlighted-background-color);\n  box-shadow: inset var(--vscode-highlight-line-highlighted-border-width) 0 0 0 var(--vscode-highlight-line-highlighted-border-color);\n}\n\n  .default-dark {\nbackground-color: #1E1E1E;\ncolor: #D4D4D4;\n}\n"))}l&&l===Object(l)&&Object.isExtensible(l)&&!l.hasOwnProperty("__filemeta")&&Object.defineProperty(l,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/pages/Get_started/Run_with_Docker.md"}}),l.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-get-started-run-with-docker-md-8f79ba5ac38cd66a70de.js.map